---
title: "Ejercicios Tema 1 - Probabilidad"
author: "Ricardo Alberich, Juan Gabriel Gomila y Arnau Mir"
date: "Curso de Probabilidad y Variables Aleatorias con R y Python"
output:
  html_document:
    df_print: paged
  pdf_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


##  Ejercicios de Espacios muestrales y sucesos

1. Se seleccionan al azar tres cartas sin reposición de una baraja que contiene 3 cartas rojas, 3 azules, 3 verdes y 3 negras. Especifica un espacio muestral para este experimento y halla todos los sucesos siguientes:
    - $A$ = "Todas las cartas seleccionadas son rojas"
    - $B$ = "Una carta es roja, 1 es verde y otra es azul"
    - $C$ = "Salen tres cartas de colores diferentes"
    
**Solución**
Nuestro espacio muestral será:
```{r}
library(gtools)
combinations(4, 3, c('R', 'A', 'V', 'N'), repeats.allowed = TRUE)
```
$$
A = \left\{RRR\right\}\\
B = \left\{RVA\right\}\\
C = \left\{RAV, RAN, RVN, AVN \right\}
$$



##  Ejercicios de Probabilidad

1. Se lanzan al aire dos monedas iguales. Hallar la probabilidad de que salgan dos caras iguales.

**Solución**

$$
P(CC) = \frac{\textrm{casos favorables}}{\textrm{casos posibles}}
$$
Nuestro espacio muestral será:

```{r}
permutations(2, 2, c('C', 'X'), repeats.allowed = TRUE)
```
$$
P(CC) = \frac{\textrm{1}}{4}
$$

2. Suponer que se ha trucado un dado de modo que la probabilidad de que salga un número es proporcional al mismo.

    - Hallar la probabilidad de los sucesos elementales, de que salga un número par y también de que salga un número impar.
    
**Solución**
Definimos nuestro espacio muestral $\Omega$:
$$
\Omega = \left\{1, 2, 3, 4, 5, 6 \right\}
$$
Sabemos que la suma de la probabilidad de todos los sucesos elementales es $1$ y que la probabilidad de que salga un número es proporcional al mismo.

\begin{eqnarray*}
1=P(\Omega) & =& P(1) + P(2) + P(3) + P(4) + P(5) + P(6)\\ 
& = & 1\cdot \alpha + 2 \cdot \alpha + 3 \cdot \alpha + 4 \cdot \alpha + 5 \cdot \alpha + 6 \cdot \alpha \\
& =& 21 \cdot \alpha
\end{eqnarray*}

luego $\alpha= \frac1{21}.$

Con esto ya sabemos la probabilidad de que salga cada suceso elemental:
$$
P(1) = \frac{1}{21}\\
P(2) = \frac{2}{21}\\
P(3) = \frac{3}{21}\\
P(4) = \frac{4}{21}\\
P(5) = \frac{5}{21}\\
P(6) = \frac{6}{21}\\
$$
Ahora calculamos la probabilidad de que salga un número par:

$$
P(par) = P(2) + P(4) + P(6) = \frac{2}{21} + \frac{4}{21} + \frac{6}{21} = \frac{12}{21} = \frac{4}{7}
$$
Y la probabilidad de que salga un número impar:

$$
P(impar) = P(1) + P(3) + P(5) = \frac{1}{21} + \frac{3}{21} + \frac{5}{21} = \frac{9}{21} = \frac{3}{7}
$$

    - Repetir el problema pero suponiendo que la probabilidad de que salga un determinado número es inversamente proporcional al mismo.

**Solución**
$$
\Omega = \left\{1, 2, 3, 4, 5, 6 \right\}\\
P(\Omega) = 1\\
P(\Omega) = P(1) + P(2) + P(3) + P(4) + P(5) + P(6) = \\ \frac{\alpha}{1} + \frac{\alpha}{2} + \frac{\alpha}{3} + \frac{\alpha}{4} + \frac{\alpha}{5} + \frac{\alpha}{6} = \frac{60\alpha + 30\alpha + 20\alpha + 15\alpha + 12\alpha + 10\alpha}{60}  \\
\frac{147\alpha}{60} = 1 \\
\alpha = \frac{60}{147} = \frac{20}{49}
$$
Con esto ya sabemos la probabilidad de que salga cada suceso elemental:
$$
P(1) = \frac{20}{49}\\
P(2) = \frac{10}{49}\\
P(3) = \frac{20}{147}\\
P(4) = \frac{10}{98}\\
P(5) = \frac{4}{49}\\
P(6) = \frac{3}{98}\\
$$
Ahora calculamos la probabilidad de par e impar: 
$$
P(par) = P(2) + P(4) + P(6) = \frac{10}{49} + \frac{10}{98} + \frac{3}{98} = \frac{33}{98} \\
P(impar) = P(1) + P(3) + P(5) = \frac{20}{49} + \frac{20}{147} + \frac{4}{49} = \frac{92}{147}
$$

3. En una prisión de 100 presos se seleccionan al azar dos personas para ponerlas en libertad. 

- ¿Cual es la probabilidad de que el más viejo de los presos sea uno de los elegidos?

**Solución**

Definimos el suceso elemental:
V: elegir al preso más viejo

$$
P(V) = \frac{\textrm{casos favorables}}{\textrm{casos posibles}}
$$
Solución a la fuerza bruta:
```{r}
casos_posibles = nrow(combinations(100, 2, repeats.allowed = FALSE))
casos_favorables = 0
viejo = 1
par_presos = combinations(100, 2, repeats.allowed = FALSE)
for(ind_par_presos in 1:casos_posibles){
  #print(ind_par_presos)
  if(par_presos[ind_par_presos, 1] == viejo || par_presos[ind_par_presos, 2] == viejo)
    casos_favorables = casos_favorables + 1
}

probabilidad_viejo = casos_favorables / casos_posibles
print(probabilidad_viejo)

```

Una manera de calcularlo sería: 
$$
P(V_1)\cdot P(V_2^c|V_1) + P(V_1^c) \cdot P(V_2|V_1^c) = \frac{1}{100} \cdot \frac{99}{99} + \frac{99}{100} \cdot \frac{1}{99} = 0.02 \\ 
$$
Otra manera de calcularlo sería:
$$
P(V) = \frac{99}{\binom{100}{2}} = 0.02
$$
- ¿Y que salga elegida la pareja formada por el más viejo y el más joven?

Nuevamente podemos hacer el cálculo bruto con R:
```{r}
casos_posibles = nrow(combinations(100, 2, repeats.allowed = FALSE))
casos_favorables = 0
viejo = 1
joven = 2
par_presos = combinations(100, 2, repeats.allowed = FALSE)
for(ind_par_presos in 1:casos_posibles){
  #print(ind_par_presos)
  if(par_presos[ind_par_presos, 1] == viejo && par_presos[ind_par_presos, 2] == joven || par_presos[ind_par_presos, 2] == viejo && par_presos[ind_par_presos, 1] == joven)
    casos_favorables = casos_favorables + 1
}

probabilidad_pareja = casos_favorables / casos_posibles
print(probabilidad_pareja)

```

Una manera de calcularlo sería:
$$
P(V_1) \cdot P(J_2|V_1) + P(J_1) \cdot P(V_2|J_1) = \frac{1}{100}\cdot \frac{1}{99} + \frac{1}{100} \cdot \frac{1}{99} = 0.0002020202 \\
$$

Otra manera de calcularlo sería:
$$
P(\textrm{pareja viejo-joven}) = \frac{1}{\binom{100}{2}} = 0.0002020202
$$

4. Se apuntan A, B i C a una carrera.

    - ¿Cuál es la probabilidad de que A acabe antes que C si todos son igual de hábiles corriendo y no puede haber empates?

**Solución**
Cálculo a fuerza bruta con R:
```{r}
gtools::permutations(n=3,r=3,v=c("A","B","C"))-> maneras
contarAC= function(x) if(which(x=="A")>which(x=="C")) { return(1)} else {0}
unlist(apply(maneras,1,contarAC))
sum(unlist(apply(maneras,1,contarAC)))
```


```{r}
n_casos_posibles = nrow(permutations(3, 3, repeats.allowed = FALSE))
casos_posibles = permutations(3, 3, repeats.allowed = FALSE)
casos_favorables = 0
A = 1
B = 2
C = 3
for(ind_caso in 1:n_casos_posibles){
  if(casos_posibles[ind_caso, 1] == A || casos_posibles[ind_caso, 2] == A && casos_posibles[ind_caso, 1] == B){
    casos_favorables = casos_favorables + 1
  }
}

probabilidad = casos_favorables / n_casos_posibles
print(probabilidad)

```

A mano:
Para que $A$ acabe antes que $C$, $A$ puede quedar en primer lugar y nos da igual en el orden en el que acaben $B$ y $C$, o $B$ puede quedar en primer lugar, $A$ en segundo y $C$ en tercero:
$$
P(A \textrm{ antes que } C) = P(A_1) + P(A_1 \textrm{ y } B_2) = \frac{1}{3} + \frac{1}{3} \cdot \frac{1}{2} = 0.5
$$


    - ¿Cuál es la probabilidad de que A acabe antes que B y C?

**Solución**
Probabilidad de que A acabe el primero    
$$
P(A_1) = \frac{1}{3}
$$

5. En una sala se hallan $n$ personas. ¿Cual es la probabilidad de que haya almenos dos personas con el mismo mes de nacimiento? Dar el resultado para los valores de  $n=3,4,5,6$.

**Solución**
Calculamos 1a la probabilidad de que ninguno de las 3 personas tenga el cumpleaños el mismo día:
$$
P(A) = 1 - \frac{364}{365} \cdot \frac{363}{365} = 0.0008204166
$$
La fórmula general sería: 

$$
P(A) = 1 - \frac{364 \cdot 363 \cdot ... (365 - n + 1)}{365^n}
$$
```{r}
probabilidad_mismo_cumpleanos = function(n){
  probabilidad_no_mismo_cumpleanos = 1
  for(ind_n in 1:n)
    probabilidad_no_mismo_cumpleanos = probabilidad_no_mismo_cumpleanos * (365 - ind_n + 1) / 365
  return(1 - probabilidad_no_mismo_cumpleanos)
}

probabilidad_mismo_cumpleanos(3)
probabilidad_mismo_cumpleanos(4)
probabilidad_mismo_cumpleanos(5)
probabilidad_mismo_cumpleanos(6)
```
 

6. Una urna contiene 4 bolas numeradas con los números 1, 2, 3 y 4, respectivamente. Se sacan dos bolas sin reposición. Sea  $A$ el suceso que la suma sea 5 y sea $B_i$ el suceso que la primera bola extraida tenga un $i$,con $i=1,2,3,4$. Hallar $P(A/B_i),\  i=1,2,3,4$ y $P(B_i/A), i=1,2,3,4$.

**Solución**
$$
P(A|B_1) = \frac{P(A \cap B_1)}{P(B_1)} = \frac{1/12}{1/4} = \frac{1}{3}
$$
$$
P(A|B_2) = \frac{P(A \cap B_2)}{P(B_2)} = \frac{1/12}{1/4} = \frac{1}{3}
$$
$$
P(A|B_3) = \frac{P(A \cap B_3)}{P(B_3)} = \frac{1/12}{1/4} = \frac{1}{3}
$$
$$
P(A|B_4) = \frac{P(A \cap B_4)}{P(B_4)} = \frac{1/12}{1/4} = \frac{1}{3}
$$
$$
P(B_1|A) = \frac{P(B_1 \cap A)}{P(A)} = \frac{1/12}{4/12} = 0.25
$$
$$
P(B_2|A) = \frac{P(B_2 \cap A)}{P(A)} = \frac{1/12}{4/12} = 0.25
$$
$$
P(B_3|A) = \frac{P(B_3 \cap A)}{P(A)} = \frac{1/12}{4/12} = 0.25
$$
$$
P(B_4|A) = \frac{P(B_4 \cap A)}{P(A)} = \frac{1/12}{4/12} = 0.25
$$

7. Se lanza al aire una moneda no trucada.

    - ¿Cuál es la probabilidad que la cuarta vez salga cara, si sale cara en las tres primeras tiradas?

**Solución**

Definimos los sucesos:

  - C: que salga cara
  - X: que salga cruz
  
Dado que son sucesos independientes, nos da igual cuántas veces hayamos tirado el dado y lo que haya salido las veces anteriores:

$$
P(C) = \frac{1}{2}
$$
    
    - ¿Y si salen 2 caras en las 4 tiradas?

**Solución**
Nuevamente, al ser sucesos independientes, nuestra probabilidad de cara será:
$$
P(C) = \frac{1}{2}
$$

8. La urna 1 contiene 2 bolas rojas y 4 de azules. La urna 2 contiene 10 bolas rojas y 2 de azules. Si escogemos al azar una urna y sacamos una bola, 

    - ¿Cuál es la probabilidad que la bola seleccionada sea azul? 

**Solución**

Definimos los sucesos:

  - 1: Escoger la urna 1
  - 2: Escoger la urna 2
  - R: Escoger una bola roja
  - A: Escoger una bola azul
  
$$
P(A) = P(1) \cdot P(A|1) + P(2) \cdot P(A|2) = \frac{1}{2}\cdot \frac{4}{6} + \frac{1}{2} \cdot \frac{2}{12} = 0.4166
$$
    - ¿Y que sea roja?

**Solución**

$$
P(R) = 1 - P(R^c) = 1 - 0.41666 = 0.5833
$$

1. Supongamos que la ciencia médica ha desarrollado una prueba para el diagnóstico de cáncer que tiene un 95\% de exactitud, tanto en los que tienen cáncer como en los que no. Si el 5 por mil de la población realmente tiene cáncer, encontrar la probabilidad que un determinado individuo tenga cáncer, si la prueba ha dado positiva.

**Solución**

Definimos los sucesos:

  - +: Prueba da positivo
  - C: Tener cancer

$$
P(C|+) = \frac{P(C) \cdot P(+|C)}{P(+)} = \\
\frac{P(C) \cdot P(+|C)}{P(C) \dot P(+|C) + P(C^c) \cdot P(+|C^c)} = \\ \frac{5/1000 \cdot 0.95}{5/1000 \cdot 0.95 + 995/1000 \cdot 0.05} = 0.087115596
$$

9. Se lanzan una sola vez dos dados. Si la suma de los dos dados es como mínimo 7, ¿cuál es la probabilidad que la suma sea igual a $i$, para $i=7,8,9,10,11,12$?

**Solución**

$$
P(suma = 7|suma \geq 7) = \frac{P(suma =7 \cap suma \geq 7)}{P(suma \geq 7)} = \\
\frac{6/36}{6/36 + 5/36 + 4/36 + 3/36 + 2/36 + 1/36} = \frac{6}{21}
$$
$$
P(suma = 8|suma \geq 7) = \frac{P(suma = 8 \cap suma \geq 7)}{P(suma \geq 7)} = \\
\frac{5/36}{6/36 + 5/36 + 4/36 + 3/36 + 2/36 + 1/36} = \frac{5}{21}
$$
$$
P(suma = 9|suma \geq 7) = \frac{P(suma =9 \cap suma \geq 7)}{P(suma \geq 7)} = \\
\frac{4/36}{6/36 + 5/36 + 4/36 + 3/36 + 2/36 + 1/36} = \frac{4}{21}
$$
$$
P(suma = 10|suma \geq 7) = \frac{P(suma = 10 \cap suma \geq 7)}{P(suma \geq 7)} = \\
\frac{3/36}{6/36 + 5/36 + 4/36 + 3/36 + 2/36 + 1/36} = \frac{3}{21}
$$

$$
P(suma = 11|suma \geq 7) = \frac{P(suma = 11 \cap suma \geq 7)}{P(suma \geq 7)} = \\
\frac{2/36}{6/36 + 5/36 + 4/36 + 3/36 + 2/36 + 1/36} = \frac{2}{21}
$$
$$
P(suma = 12|suma \geq 7) = \frac{P(suma =12 \cap suma \geq 7)}{P(suma \geq 7)} = \\
\frac{1/36}{6/36 + 5/36 + 4/36 + 3/36 + 2/36 + 1/36} = \frac{1}{21}
$$

10. Se sabe que ${2 \over 3}$ de los internos de una cierta prisión son menores de 25 años. También se sabe que ${3\over 5}$ son hombres y que ${5\over 8}$ de los internos son mujeres o mayores de 25 años. ¿Cuál es la probabilidad de que un prisionero escogido al azar sea mujer y menor de 25 años?

**Solución**

Sean los sucesos:

  - M: interno menor de 25 años
  - H: interno hombre

Nos dan los siguientes datos:

  - $P(M) = \frac{2}{3}$
  - $P(H) = \frac{3}{5}$
  - $P(M^c \cup H^c) = \frac{5}{8}$
  
Queremos calcular $P(M\cap H^c)$:

$$
P(M\cap H^c) = P(M) - P(M \cap H) = \\
P(M) - (1 - P((M \cap H)^c)) = P(M) - (1 - P(M^c \cup H^c)) = \\
\frac{2}{3} - \left(1 - \frac{5}{8} \right) = 0.29
$$

11. Consideremos una hucha con $2n$ bolas numeradas del $1$ al $2n$. Sacamos $2$ bolas de la urna sin reposición. Sabiendo que la segunda bola es par, ¿cuál es la probabilidad de que la primera bola sea impar?

**Solución**

Definimos los sucesos:

  - $P_2$: que la segunda bola sea par
  - $I_1$: que la primera bola se impar

$$
P(I_1 | P_2) = \frac{P(P_2 \cap I_1)}{P(P_2)}
$$

Como el número de bolas siempre es par porque son $2n$ sabemos que siempre va a haber el mismo número de bolas pares que impares, por tanto la probabilidad de que la segunda bola sea par será:

$$
P(P_2) = \frac{1}{2}
$$
$$
P(P_2 \cap I_1)
$$
Dependerá del valor de $n$. En cualquier caso,

$$
P(P_2 \cap I_1) = \frac{\textrm{casos favorables}}{\textrm{casos posibles}}
$$
Los casos posibles serán variaciones 2 bolas de un conjunto de $2n$ bolas:

$$
V^{2n}_2 = \frac{(2n)!}{(2n - 2)!} = 2n\cdot (2n-1) 
$$

Los casos posibles serán $n^2$. Por tanto lo podemos reescribir todo de la siguiente manera:

$$
P(I_1|P_2) = \frac{P(P_2 \cap I_1)}{P(P_2)} = \frac{\frac{n^2}{\frac{(2n))!}{(2n - 2)!}}}{1/2} = \frac{n}{2n-1}
$$

12. Consideramos el siguiente experimento aleatorio: sacamos $5$ números al azar sin reposición a partir de los números naturales $1,2,\dots,20$. Encontrad la probabilidad $p$ de que haya exactamente dos números tales que sean múltiplos de $3$

**Solución**

Mútiplos de 3 = {3, 6, 9, 12, 15, 18}

A fuerza bruta con R:
```{r}
casos_posibles = combinations(20, 5)
casos_favorables = 0
for(ind_caso in 1:nrow(casos_posibles)){
  if(sum(casos_posibles[ind_caso, ] %% 3 == 0) == 2)
    casos_favorables = casos_favorables + 1
}
casos_favorables/nrow(casos_posibles)
```
Haciendo el cálculo:

Definimos el suceso:

  -$M$: sacar múltiplo de 3

Existen 10 maneras en las que podemos sacar exactamente 2 múltiplos de 3: 

$$
M, M, M^c, M^c, M^c \\
M, M^c, M, M^c, M^c \\
M, M^c, M^c, M, M^c \\
M, M^c, M^c, M^c, M \\
M^c, M, M, M^c, M^c \\
M^c, M, M^c, M, M^c \\
M^c, M, M^c, M^c, M \\
M^c, M^c, M, M, M^c \\
M^c, M^c, M, M^c, M \\
M^c, M^c, M^c, M, M
$$
Calculemos la probabilidad del primer caso:

$$
P(M, M, M^c, M^c, M^c) = \frac{6}{20} \cdot \frac{5}{19} \cdot \frac{14}{18} \cdot \frac{13}{17} \cdot \frac{12}{16} = 0.03521672
$$
Cada uno de los 10 casos tiene la misma probabilidad de suceder, por tanto: 

$$
P(\textrm{dos múltiplos de 3}) = 10 \cdot 0.03521672 = 0.3521672
$$
  



13. En una hucha hay $10$ bolas, numeradas del $1$ al $10$. Las $4$ primeras bolas, o sea, las bolas $1,2,3,4$ son blancas. Las bolas $5,6$ son negras y las bolas restantes son rojas. Sacamos dos bolas sin reposición. Sabiendo que la segunda bola es de color negro, encuentra la probabilidad $p$ de que la primera bola sea blanca.

**Solución**

A la fuerza bruta con R:
```{r}
B = c(1, 2, 3, 4)
N = c(5, 6)
R = c(7, 8, 9, 10)
casos_posibles = permutations(10, 2)
casos_favorables = 0
n_casos_posibles = 0
for(ind_caso in 1:nrow(permutations(10, 2))){
  if (casos_posibles[ind_caso, 2] %in% N){
    n_casos_posibles = n_casos_posibles + 1
  if(casos_posibles[ind_caso, 1] %in% B)
    casos_favorables = casos_favorables + 1
    }
  
}

casos_favorables/n_casos_posibles
```

Calculándolo:

Definimos los sucesos:

  - $B_i$: que la bola $i$ sea blanca
  - $N_2$: que la bola $i$ sea negra

$$
P(B_1|N_2) = \frac{P(B_1 \cap N_2)}{P(N_2)} = \\
\frac{P(B_1 \cap N_2)}{P(N_1^c)\cdot P(N_2 |N_1^c) + P(N_1) \cdot P(N_2|N_1)} = \\
\frac{4/10 \cdot 2/9}{8/10 \cdot 8/9 + 2/10 \cdot 1/9} = 0.4444
$$

14. Lanzamos un dado no trucado 3 veces. Encontrad la probabilidad $p$ de que la suma de las 3 caras sea $10$.

**Solución**

```{r}
casos_favorables = 0
casos_posibles = 0
for (dado_1 in 1:6){
  for (dado_2 in 1:6){
    for (dado_3 in 1:6){
      casos_posibles = casos_posibles + 1
      if (dado_1 + dado_2 + dado_3 == 10)
        casos_favorables = casos_favorables + 1
    }
  }
}

casos_favorables/casos_posibles
```



15. 4 cartas numeradas del 1 al 4 están giradas boca abajo sobre una mesa. Una persona, supuestamente adivina, irá adivinando los valores de las 4 cartas una a una. Suponiendo que es un farsante y que lo que hace es decir los 4 números al azar, ¿cuál es la probabilidad de que acierte como mínimo 1? (Obviamente, no repite ningún número)

**Solución**

A fuerza bruta con R:

```{r}
cartas = c(1, 2, 3, 4)
permutaciones = permutations(4, 4)
casos_favorables = 0
for(ind_caso in 1:nrow(permutaciones)){
  caso = permutaciones[ind_caso, ]
  if(sum(caso == cartas) >= 1){
    casos_favorables = casos_favorables + 1
  }
}

casos_favorables/nrow(permutaciones)
```

Calculándolo:

$$
P(\textrm{acierte al menos 1} = 1 - P(\textrm{no acierte ninguna})) = \frac{3\cdot 3 \cdot 1 \cdot 1}{4!} = \frac{15}{24}
$$
16. Una forma de aumentar la fiabilidad de un sistema es mediante la introducción de una copia de los componentes en una configuración paralela. Supongamos que la NASA quiere una probabilidad no menor que 0.99999 de que el transbordador espacial entre en órbita alrededor de la Tierra con éxito. ¿Cúantos motores se deben configurar en paralelo para que se consiga dicha fiabilidad si se sabe que la probabilidad de que un motor funcione adecuadamente es 0.95? Supongamos que los motores funcionan de manera independiente los unos con los otros.

**Solución**

Definimos el suceso:

  - $E_1$: éxito del motor$i$

$$
P(E_1) = 0.95
$$
Nos preguntan cuántos motores hay que poner para que la probabilidad de que al menos 1 tenga éxito sea como mínimo 0.99999, que es igual que decir que buscamos la configuración que con un mínimo de un 0.99999 de probabilidad no va a tener ningún motor que falle:
$$
P(E_1 \cup E\_2 \cup \dots) = 0.99999 = 1 - P(E_1^c \cap E_2^c \cap \dots) = 1 - 0.05^n
$$
Resolvemos la inecuación:

$$
1 - 0.05^n \geq 0.99999 \\
0.05^n \geq 0.00001 \\
n \geq log_{0.05}(0.00001) \\
n \geq 3.842109 \\
n = 4
$$


##  Ejercicios de Independencia de sucesos

1. Una moneda no trucada se lanza al aire 2 veces Consideremos los siguientes sucesos:

    - A: Sale una cara en la primera tirada.
    - B: Sale una cara en la segunda tirada.

    ¿Son los sucesos A y B independientes?
    
Si

2. Una urna contiene 4 bolas numerades con los números 1, 2, 3 y 4, respectivamente. Se extraen dos bolas sin reposición. Sea A el suceso que la primera bola extraida tenga un 1 marcado y sea B el suceso que la segunda bola extraida tenga un 1 marcado. 

    - ¿Se puede decir que A y B son independientes?
No
    - ¿Y si el experimento fuera con reposición?
Si



3. Sea $\Omega$ un espacio muestral y $A,B,C$ tres sucesos. Probad que

    - Si $A$ y $B$ son independientes, también lo son $A$ y $B^c$

Si los sucesos $A$ y $B$ son independientes:
$$
P(A \cap B) = P(A)\cdot P(B)
$$
Para que los sucesos $A$ y $B^c$ sean independientes se tiene que cumplir:

$$
P(A \cap B^c) = P(A) \cdot P(B^c)
$$
$$
P(A \cap B^c) = P(A) - P(A \cap B) = P(A) \cdot (1 - P(B)) = P(A) \cdot P(B^c)
$$
Queda demostrado que $A$ y $B^c$ son sucesos independientes.
    
    - Si $A,B,C$ son independientes, también lo son $A,B$ y $C^c$
    
Si $A,B,C$ son independientes significa que:

$$
P(A \cap B \cap C) = P(A) \cdot P(B) \cdot P(C)
$$
Y queremos comprobar que:
$$
P(A \cap B \cap C^c) = P(A) \cdot P(B) \cdot P(C^c)
$$
Sabemos que:
$$
P(A \cap B \cap C^c) = P(A \cap B) - P(A \cap B \cap C) = \\
P(A) \cdot P(B) - P(A)\cdot P(B) \cdot P(C) = \\
P(A) \cdot P(B) \cdot (1 - P(C)) = \\
P(A) \cdot P(B) \cdot P(C^c)
$$
    - ¿Es cierto que si $A,B,C$ son independientes, también lo son $A,B^c$ y $C^c$? ¿Y $A^c, B^c$ y $C^c$? En caso de que la respuesta sea negativa, dad contraejemplos donde la propiedad falle.

Si:
$$
P(A \cap B \cap C) = P(A) \cdot P(B) \cdot P(C)
$$
Queremos comprobar si:
$$
P(A \cap B^c \cap C^c) = P(A) - P(A \cap B) - P(A \cap C) + P(A \cap B \cap C) = \\
P(A) - P(A) \cdot P(B) - P(A) \cdot P(C) + P(A) \cdot P(B) \cdot P(C) = \\
P(A) \cdot (1 - P(B) - P(C) + P(B)\cdot P(C)) = \\
P(A) \cdot (1 - P(B) - P(C) \cdot (1 + P(B))) = \\
P(A) \cdot (1 - P(B) + P(C) \cdot (-1 - P(B))) = \\
P(A) \cdot (P(B^c) + P(C) \cdot -P(B^c)) = \\
P(A) \cdot (P(B^c) \cdot (1- P(C))) = \\
P(A) \cdot P(B^c) \cdot (P(C^c))
$$

4. Dos empresas $A$ y $B$ fabrican el mismo producto. La empresa $A$ tiene un $2\%$ de productos defectuosos mientras que la empresa $B$ tiene un $1\%$. Un cliente recibe un pedido de una de las empresas (no sabe cuál) y comprueba que la primera pieza funciona. Si suponemos que el estado de las piezas de cada empresa es independiente, ¿cuál es la probabilidad de que la segunda pieza que pruebe sea buena? Comprobad que el estado de las dos piezas no es independiente, pero en cambio es condicionalmente independiente dada la empresa que las fabrica.

5. Encuentra un ejemplo de tres sucesos $A,B,C$ tales que $A$ y $B$ sean independientes, pero en cambio no sean condicionalmente independientes dado $C$.